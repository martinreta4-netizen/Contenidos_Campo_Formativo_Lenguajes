<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>ODA Lenguajes (Est√°ndar) ‚Äì Textos explicativos ¬∑ Fase 5</title>
  <style>
    :root{
      --red:#8B0000;
      --red-2:#5A0000;
      --red-soft:#F5EAEA;
      --ink:#1A1A1A;
      --muted:#5b5b5b;
      --card:#ffffff;
      --border:#e6e6e6;
      --shadow:0 18px 42px rgba(0,0,0,.16);
      --ok:#0f7a3d;
      --bad:#b91c1c;
      --warn:#a16207;
      --bg: linear-gradient(180deg, #ffffff 0%, #fff7f7 40%, #f8fafc 100%);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
      background:var(--bg);
      color:var(--ink);
      overflow:auto; 
    }
    body::before{
      content:"";
      position:fixed;
      inset:10% 14%;
      background:url("escudo_escuela.png") center/contain no-repeat;
      opacity:.035;
      pointer-events:none;
      z-index:0;
    }

    .app{position:relative; z-index:1; height:100%; display:flex; flex-direction:column;}
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; padding:10px 14px;
      background:linear-gradient(90deg, var(--red), #3b0000);
      color:#fff; box-shadow:0 10px 24px rgba(0,0,0,.22);
    }
    .brand{display:flex; align-items:center; gap:10px; min-width:0;}
    .brand img{height:40px; width:auto; background:#fff; padding:3px 8px; border-radius:10px}
    .brand .titles{min-width:0}
    .brand .titles h1{font-size:1.02rem; margin:0; line-height:1.15; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .brand .titles .sub{font-size:.82rem; opacity:.92; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .top-actions{display:flex; gap:8px; flex-wrap:wrap; align-items:center; justify-content:flex-end;}

    .btn{
      border:none; border-radius:999px;
      padding:8px 12px; cursor:pointer;
      font-weight:900; font-size:.82rem;
      display:inline-flex; align-items:center; gap:6px;
      transition:transform .12s ease, background .12s ease, box-shadow .12s ease, opacity .12s ease;
      user-select:none; white-space:nowrap;
    }
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:var(--red); color:#fff; box-shadow:0 10px 22px rgba(139,0,0,.28);}
    .btn-primary:hover{background:var(--red-2)}
    .btn-ghost{background:rgba(255,255,255,.12); color:#fff; border:1px solid rgba(255,255,255,.25);}
    .btn-ghost:hover{background:rgba(255,255,255,.18)}
    .btn-light{background:#fff; color:var(--red);}
    .btn-light:hover{background:#f2f2f2}
    .btn-disabled{opacity:.55; pointer-events:none}

    .pill{
      display:inline-flex; align-items:center; gap:8px;
      border-radius:999px; padding:6px 10px;
      background:rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.20);
      font-size:.78rem; color:#fff; white-space:nowrap;
    }
    .pill strong{font-weight:1000}

    .main{
  flex:1;
  min-height:0;
  overflow:hidden; /* ‚úÖ el scroll queda adentro de panel-body */
  display:grid;
  grid-template-columns:320px minmax(0, 1fr);
  gap:12px;
  padding:12px;
}

    }
    @media(max-width:980px){
      body{overflow:auto}
      .main{grid-template-columns:1fr; overflow:auto}
    }

    .panel{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:22px;
      box-shadow:var(--shadow);
      overflow:hidden;
      min-height:0;
      display:flex;
      flex-direction:column;
    }
    .panel-head{
      padding:12px 12px 10px;
      border-bottom:1px solid var(--border);
      background:linear-gradient(180deg, #ffffff, #fff7f7);
    }
    .panel-head h2{margin:0; font-size:.95rem; display:flex; align-items:center; gap:8px; color:var(--red);}
    .panel-body{
  padding:12px;
  overflow:auto;          /* ‚úÖ barra dentro del panel */
  min-height:0;           /* ‚úÖ clave para que funcione en grid/flex */
}


    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:8px}
    @media(max-width:980px){.grid2{grid-template-columns:1fr}}
    .field{display:flex; flex-direction:column; gap:4px; font-size:.82rem;}
    label{font-weight:1000; color:#333}
    input[type="text"]{
      border:1px solid var(--border);
      border-radius:999px;
      padding:8px 10px;
      font-size:.86rem;
      outline:none;
    }
    input[type="text"]:focus{border-color:var(--red); box-shadow:0 0 0 2px rgba(139,0,0,.15)}
    .avatarRow{
      display:grid; grid-template-columns:92px 1fr; gap:10px; align-items:center;
      margin-top:8px;
      padding:10px;
      border:1px dashed #f0c7c7;
      border-radius:18px;
      background:var(--red-soft);
    }
    .avatarRow img{width:92px; height:auto; display:block}
    .avatarRow .talk{font-size:.84rem; color:#2d2d2d;}
    .avatarRow .talk strong{color:var(--red)}
    .small{font-size:.78rem; color:var(--muted);}

    .menu{display:flex; flex-direction:column; gap:8px; margin-top:10px;}
    .menuBtn{
      width:100%;
      text-align:left;
      border-radius:16px;
      border:1px solid #f0d5d5;
      background:#fff;
      padding:10px 10px;
      cursor:pointer;
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      color:#2d2d2d;
      transition:transform .12s ease, box-shadow .12s ease, border .12s ease;
    }
    .menuBtn:hover{transform:translateY(-1px); box-shadow:0 10px 18px rgba(0,0,0,.08); border-color:#e6b7b7}
    .menuBtn .left{display:flex; gap:10px; align-items:flex-start}
    .badge{
      width:26px; height:26px; border-radius:999px;
      display:flex; align-items:center; justify-content:center;
      font-weight:1000;
      background:var(--red);
      color:#fff;
      flex:0 0 auto;
      box-shadow:0 8px 14px rgba(139,0,0,.18);
      margin-top:2px;
    }
    .menuBtn .t{font-weight:1000; color:#1f1f1f; font-size:.88rem}
    .menuBtn .s{font-size:.78rem; color:var(--muted); margin-top:2px}
    .menuBtn.active{
      border-color:rgba(139,0,0,.65);
      box-shadow:0 14px 22px rgba(139,0,0,.16);
      background:linear-gradient(180deg,#fff, #fff4f4);
    }
    .menuBtn .right{font-size:1.05rem; color:var(--red); margin-top:2px;}

    .card{
      border:1px solid var(--border);
      border-radius:20px;
      background:#fff;
      padding:12px;
      margin-bottom:10px;
    }
    .card h3{
      margin:0 0 6px;
      font-size:.95rem;
      color:var(--red);
      display:flex; align-items:center; gap:8px;
    }
    .card p{margin:6px 0; color:#2b2b2b; font-size:.9rem; line-height:1.45}
    .metaLine{display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-top:8px;}
    .chip{
      display:inline-flex; align-items:center; gap:6px;
      padding:6px 10px; border-radius:999px;
      background:var(--red-soft);
      border:1px solid #f0c7c7;
      font-size:.78rem;
      color:#2b2b2b;
      font-weight:1000;
    }
    .chip .dot{width:8px; height:8px; border-radius:999px; background:var(--red)}

    .reading{
      padding:12px;
      border-radius:18px;
      border:1px solid #f1d0d0;
      background:#fff;
      line-height:1.55;
      font-size:.92rem;
    }
    .reading .k{
      display:inline-flex;
      padding:2px 8px;
      border-radius:999px;
      background:var(--red);
      color:#fff;
      font-weight:1000;
      font-size:.75rem;
      margin-bottom:8px;
    }

    .activity{
      border:1px solid #eedcdc;
      border-radius:18px;
      padding:12px;
      background:#fff;
      margin-top:10px;
    }
    .activity .head{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin-bottom:6px;
    }
    .activity .head .title{
      font-weight:1000; color:var(--red);
      display:flex; align-items:center; gap:8px;
    }
    .attempts{
      font-size:.78rem; color:#444;
      background:var(--red-soft);
      border:1px solid #f1caca;
      border-radius:999px;
      padding:5px 10px;
      font-weight:1000;
      display:inline-flex; gap:6px; align-items:center;
      white-space:nowrap;
    }

    .q{
      padding:10px;
      border-radius:14px;
      border:1px solid var(--border);
      background:#fafafa;
      margin-top:8px;
    }
    .q .qt{font-weight:1000; margin-bottom:8px}
    .options{display:grid; gap:6px;}
    .opt{
      display:flex; gap:8px; align-items:flex-start;
      background:#fff;
      border:1px solid #e9e9e9;
      border-radius:12px;
      padding:8px 10px;
      cursor:pointer;
    }
    .opt input{margin-top:3px}
    .opt:hover{border-color:#d6b0b0}

    .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-top:10px;}
    .status{
      margin-top:10px;
      border-radius:14px;
      padding:10px 10px;
      font-size:.86rem;
      border:1px solid var(--border);
      background:#fff;
      display:flex; gap:10px; align-items:flex-start;
    }
    .status .ico{
      width:22px; height:22px; border-radius:999px;
      display:flex; align-items:center; justify-content:center;
      font-weight:1000; color:#fff; flex:0 0 auto;
      margin-top:1px;
    }
    .status.info .ico{background:var(--red)}
    .status.ok .ico{background:var(--ok)}
    .status.bad .ico{background:var(--bad)}
    .status.warn .ico{background:var(--warn)}
    .divider{height:1px; background:var(--border); margin:10px 0}

    .resultsGrid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));
      gap:8px;
      margin-top:8px;
    }
    .resultPill{
      border-radius:999px;
      padding:8px 10px;
      border:1px solid #eedcdc;
      background:#fff;
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      font-size:.82rem;
    }
    .resultPill .v{font-weight:1000; color:var(--ok)}
    .resultPill.bad .v{color:var(--bad)}

    /* ==== Juegos UI ==== */
    .gameGrid{
      display:grid;
      gap:8px;
      margin-top:8px;
    }
    .cols2{grid-template-columns:1fr 1fr}
    @media(max-width:980px){.cols2{grid-template-columns:1fr}}
    .box{
      border:1px solid var(--border);
      border-radius:14px;
      background:#fff;
      padding:10px;
    }
    .box h4{margin:0 0 8px; color:var(--red); font-size:.88rem}
    .chipBtn{
      border:1px solid #e9e9e9;
      background:#fff;
      border-radius:999px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:900;
      text-align:left;
    }
    .chipBtn:hover{border-color:#d6b0b0}
    .chipBtn.selected{border-color:rgba(139,0,0,.75); box-shadow:0 0 0 2px rgba(139,0,0,.12)}
    .pairRow{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid #eee;
      background:#fafafa;
      margin-top:6px;
    }
    .miniTag{
      font-size:.75rem;
      padding:4px 8px;
      border-radius:999px;
      background:var(--red-soft);
      border:1px solid #f0c7c7;
      font-weight:900;
    }

    .draggable{
      user-select:none;
      cursor:grab;
    }
    .draggable:active{cursor:grabbing}
    .dropZone{
      border:2px dashed #e9baba;
      border-radius:14px;
      padding:10px;
      background:#fff;
      min-height:44px;
    }
    .dropZone.filled{border-style:solid; border-color:rgba(139,0,0,.35); background:#fff7f7}
    .hint{font-size:.78rem; color:var(--muted); margin-top:6px}

    .hangWord{
      font-weight:1000;
      letter-spacing:.25em;
      font-size:1.05rem;
      padding:10px;
      border-radius:14px;
      background:#fff;
      border:1px solid var(--border);
      display:inline-block;
    }
    .kbd{
      display:grid;
      grid-template-columns:repeat(9, minmax(0,1fr));
      gap:6px;
      margin-top:10px;
    }
    @media(max-width:980px){.kbd{grid-template-columns:repeat(7, minmax(0,1fr))}}
    .kbtn{
      border:1px solid #e9e9e9;
      background:#fff;
      border-radius:10px;
      padding:8px 0;
      font-weight:1000;
      cursor:pointer;
    }
    .kbtn:hover{border-color:#d6b0b0}
    .kbtn.used{opacity:.45; pointer-events:none}

    .wsGrid{
      display:grid;
      gap:4px;
      margin-top:8px;
      user-select:none;
    }
    .wsCell{
      width:34px; height:34px;
      display:flex; align-items:center; justify-content:center;
      border:1px solid #eee;
      border-radius:8px;
      background:#fff;
      font-weight:1000;
      cursor:pointer;
    }
    .wsCell.sel{background:#fff0f0; border-color:#e7b7b7}
    .wsCell.ok{background:#eaf7ef; border-color:#bfe6cc}
    .wsBar{
      display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-top:10px;
    }
    .wsInput{
      flex:1;
      border:1px solid var(--border);
      border-radius:999px;
      padding:8px 10px;
      font-weight:900;
      min-width:160px;
      background:#fff;
    }

    .memGrid{
      display:grid;
      grid-template-columns:repeat(4, minmax(0,1fr));
      gap:8px;
      margin-top:8px;
    }
    @media(max-width:980px){.memGrid{grid-template-columns:repeat(3, minmax(0,1fr))}}
    .memCard{
      height:74px;
      border:1px solid #e9e9e9;
      border-radius:14px;
      background:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      font-weight:1000;
      text-align:center;
      padding:8px;
    }
    .memCard.revealed{background:#fff7f7; border-color:#e7b7b7}
    .memCard.matched{background:#eaf7ef; border-color:#bfe6cc; cursor:default}

    /* Cover */
    .cover{
      position:fixed; inset:0; z-index:50;
      background:radial-gradient(circle at top, #a30000 0%, #3b0000 55%, #160000 100%);
      color:#fff;
      display:flex; align-items:center; justify-content:center;
      padding:16px;
    }
    .coverInner{
      width:100%; max-width:1100px;
      background:rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.16);
      border-radius:26px;
      padding:18px;
      box-shadow:0 26px 70px rgba(0,0,0,.55);
      display:grid;
      grid-template-columns:minmax(0,1.25fr) minmax(0,.9fr);
      gap:16px;
    }
    @media(max-width:920px){.coverInner{grid-template-columns:1fr}}
    .coverLeft h1{margin:6px 0 6px; font-size:1.55rem; line-height:1.15}
    .tag{
      display:inline-flex; gap:8px; align-items:center;
      font-size:.78rem; font-weight:1000;
      text-transform:uppercase; letter-spacing:.05em;
      padding:6px 10px; border-radius:999px;
      background:rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.18);
    }
    .coverMeta{margin-top:8px; font-size:.92rem; opacity:.94}
    .coverMeta b{color:#fff}
    .coverBtns{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    .coverRight{
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      border-radius:22px;
      padding:14px;
    }
    .coverRight .logos{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .coverRight .logos img{height:46px; background:#fff; padding:3px 8px; border-radius:12px}
    .coverRight .av{
      display:grid; grid-template-columns:110px 1fr; gap:12px; align-items:center;
      margin-top:10px;
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.12);
      border-radius:18px;
      padding:10px;
    }
    .coverRight .av img{width:110px; height:auto}
    .coverRight .av .t{font-size:.88rem; line-height:1.35}
    .credits{margin-top:10px; font-size:.78rem; opacity:.9; line-height:1.35;}

    @media print{
      body{overflow:visible; background:#fff}
      .cover, .topbar{display:none !important}
      .main{grid-template-columns:1fr; padding:0}
      .panel{box-shadow:none}
      .panel-body{overflow:visible}
      .no-print{display:none !important}
      body::before{display:none !important}
    }
  </style>
</head>

<body>
  <section class="cover" id="cover">
    <div class="coverInner">
      <div class="coverLeft">
        <div class="tag">üìö Lenguajes ¬∑ Fase 5</div>
        <h1>ODA de Lenguajes (Est√°ndar)</h1>
        <div class="coverMeta">
          <div><b>Contenido:</b> Comprensi√≥n y producci√≥n de textos explicativos.</div>
          <div><b>Actividades:</b> 2 por PDA ¬∑ 2 intentos ¬∑ Autoevaluables (sin escritura).</div>
          <div style="margin-top:8px"><b>Elige tu grado:</b></div>
        </div>
        <div class="coverBtns">
          <button class="btn btn-primary" onclick="startGrade('5')">üü£ Entrar a 5.¬∫</button>
          <button class="btn btn-primary" onclick="startGrade('6')">üîµ Entrar a 6.¬∫</button>
          <button class="btn btn-ghost" onclick="speakCover()">üîä Escuchar instrucciones</button>
        </div>
        <div class="credits">
          ODA creada por el Maestro Mart√≠n Reta<br/>¬© Derechos reservados ¬∑ Uso educativo
        </div>
      </div>

      <div class="coverRight">
        <div class="logos">
          <img src="../../img/sep_logo.png" alt="SEP" />
          <img src="../../img/escudo_escuela.png" alt="Escuela" />
        </div>
        <div class="av">
          <img src="../../img/avatar_guia.png" alt="Avatar gu√≠a" />
          <div class="t">
            <b>Hola, soy tu gu√≠a.</b><br/>
            Lee un texto breve y realiza actividades din√°micas: relacionar, ordenar, ahorcado, sopa y memorama.
            Recuerda: <b>solo 2 intentos</b>.
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="app" id="app" style="display:none;">
    <header class="topbar">
      <div class="brand">
        <img src="../../img/sep_logo.png" alt="SEP" />
        <div class="titles">
          <h1>ODA Lenguajes ‚Äì Textos explicativos</h1>
          <div class="sub" id="topSub">Fase 5 ¬∑ Selecciona un PDA</div>
        </div>
      </div>
      <div class="top-actions no-print">
        <span class="pill">üë§ <strong id="pillName">Sin nombre</strong></span>
        <span class="pill">üéì Grado: <strong id="pillGrade">‚Äî</strong></span>
        <button class="btn btn-ghost" onclick="speakCurrent()">üîä Voz</button>
        <button class="btn btn-light" onclick="printResults()">üñ®Ô∏è Imprimir</button>
      </div>
    </header>

    <div class="main">
      <aside class="panel">
        <div class="panel-head"><h2>üßë‚Äçüéì Datos y navegaci√≥n</h2></div>
        <div class="panel-body">
          <div class="grid2">
            <div class="field">
              <label for="studentName">Nombre del alumno(a)</label>
              <input id="studentName" type="text" placeholder="Escribe tu nombre" oninput="setName(this.value)" />
            </div>
            <div class="field">
              <label for="group">Grupo</label>
              <input id="group" type="text" placeholder="Ej. 6¬∞ A" />
            </div>
          </div>

          <div class="avatarRow">
            <img src="avatar_guia.png" alt="Avatar gu√≠a" />
            <div class="talk">
              <strong>Gu√≠a:</strong> Todas las Actividades 2 son din√°micas (sin escribir). Cada actividad tiene <b>2 intentos</b>.
              <div class="small" style="margin-top:6px">Tip: Lee primero, luego juega.</div>
            </div>
          </div>

          <div class="divider"></div>
          <div class="field">
            <label>Men√∫ de PDA</label>
            <div class="small">Botones en rojo oscuro (alto contraste).</div>
          </div>

          <div class="menu" id="pdaMenu"></div>

          <div class="divider"></div>
          <button class="btn btn-primary" style="width:100%; justify-content:center" onclick="goHome()">üè† Volver a portada</button>
        </div>
      </aside>

      <section class="panel">
        <div class="panel-head"><h2>üìå Trabajo del PDA</h2></div>
        <div class="panel-body" id="contentArea"></div>
      </section>
    </div>
  </div>

  <script>
    /* ===================== PDA LITERALES (5 y 5) ===================== */
    const CONTENT_TITLE = "Comprensi√≥n y producci√≥n de textos explicativos.";

    const PDAS = {
      "5": [
        "Lee distintos tipos de textos explicativos y reflexiona sobre sus caracter√≠sticas y funciones.",
        "Expone las diferencias entre una descripci√≥n y una explicaci√≥n, y entre un texto descriptivo y uno explicativo.",
        "Recupera informaci√≥n de distintas fuentes, como art√≠culos de divulgaci√≥n, libros de texto, reportes de investigaci√≥n, para producir un texto explicativo sobre temas diversos y con prop√≥sitos particulares.",
        "Establece relaciones causales y emplea expresiones como en consecuencia, por lo tanto, debido a, a causa de, porque, por consiguiente.",
        "Distingue sus propias palabras de la par√°frasis y citas textuales, y registra la informaci√≥n bibliogr√°fica de las fuentes consultadas: autor, t√≠tulo, editorial, lugar y fecha de publicaci√≥n, p√°ginas consultadas, etc√©tera."
      ],
      "6": [
        "Localiza y lee textos explicativos de temas variados.",
        "Expresa con sus palabras las ideas que comprende de los textos que lee y elabora res√∫menes que le permitan reconstruir las ideas principales y los elementos de los textos explicativos.",
        "Reconoce y emplea relaciones de causa-consecuencia.",
        "Emplea palabras como primero, finalmente, luego, despu√©s, posteriormente, durante, para organizar las oraciones.",
        "Utiliza palabras nuevas y/o t√©cnicas en el texto explicativo que produce para compartir."
      ]
    };

    /* ===================== M√ìDULOS: LECTURA + Act1(MCQ) + Act2(JUEGO) ===================== */
    const MODULES = {
      "5": [
        {
          shortName:"Tipos de textos",
          reading:{
            title:"Lectura: ¬øC√≥mo se forma la lluvia?",
            text:`La lluvia es un fen√≥meno natural que ocurre cuando el vapor de agua que est√° en el aire se convierte en gotas y cae a la superficie. Todo comienza con el calor del Sol: al calentar mares, r√≠os, lagos y hasta charcos, parte del agua se evapora. Evaporarse significa pasar de l√≠quido a gas. Ese gas sube porque es m√°s ligero y forma parte del aire h√∫medo.

Cuando el vapor sube, encuentra zonas m√°s fr√≠as en la atm√≥sfera. Al enfriarse, el vapor se condensa, es decir, se transforma otra vez en peque√±as gotas de agua. Estas gotas son tan peque√±as que quedan ‚Äúflotando‚Äù y se agrupan formando nubes. A veces tambi√©n se forma hielo si la temperatura es muy baja. Dentro de la nube, las gotas chocan entre s√≠ y se unen, volvi√©ndose cada vez m√°s grandes.

Si las gotas se vuelven demasiado pesadas, la nube ya no puede sostenerlas. Entonces ocurre la precipitaci√≥n: las gotas caen como lluvia. Si hace mucho fr√≠o, la precipitaci√≥n puede caer como nieve o granizo. En consecuencia, el tipo de precipitaci√≥n depende de la temperatura del aire.

Este proceso es importante porque el agua de la lluvia regresa a la tierra y alimenta r√≠os y lagos. Adem√°s, permite que las plantas crezcan y que los seres vivos tengan agua disponible. Por lo tanto, la lluvia es parte esencial del ciclo del agua: evapora, condensa, precipita y vuelve a comenzar.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Comprendo el texto",
            questions:[
              {q:"¬øQu√© provoca que el agua se evapore?", options:[
                {t:"El calor del Sol.", correct:true},{t:"El viento √∫nicamente.", correct:false},{t:"La oscuridad de la noche.", correct:false}
              ]},
              {q:"¬øQu√© significa condensaci√≥n?", options:[
                {t:"Que el vapor se convierte en gotas.", correct:true},{t:"Que el agua se convierte en humo.", correct:false},{t:"Que las nubes desaparecen.", correct:false}
              ]},
              {q:"¬øPor qu√© cae la lluvia?", options:[
                {t:"Porque las gotas se vuelven pesadas.", correct:true},{t:"Porque la nube se vuelve roja.", correct:false},{t:"Porque el aire deja de existir.", correct:false}
              ]},
              {q:"Una idea principal del texto es que la lluvia‚Ä¶", options:[
                {t:"es parte del ciclo del agua.", correct:true},{t:"solo ocurre en ciudades.", correct:false},{t:"no depende de la temperatura.", correct:false}
              ]}
            ]
          },
          act2:{ type:"wordsearch", title:"Actividad 2: Sopa de letras (conceptos)",
            prompt:"Encuentra y marca las palabras del ciclo del agua. Selecciona letras para formar una palabra y pulsa ‚ÄúRegistrar palabra‚Äù.",
            gridSize:10,
            words:["LLUVIA","VAPOR","NUBE","SOL","CICLO","GOTAS","FRIO"],
          }
        },
        {
          shortName:"Descripci√≥n vs explicaci√≥n",
          reading:{
            title:"Lectura: El r√≠o del pueblo y su contaminaci√≥n",
            text:`Un r√≠o puede describirse y tambi√©n puede explicarse. Si lo describimos, decimos c√≥mo se ve: el color del agua, el sonido que hace al correr, las piedras de la orilla, los √°rboles que lo rodean y si huele bien o mal. Una descripci√≥n usa muchos detalles para que la persona imagine el lugar. Por ejemplo, podr√≠amos decir: ‚ÄúEl r√≠o es angosto, su agua se ve verdosa y en la orilla hay ramas y hojas‚Äù.

Pero una explicaci√≥n responde otras preguntas: ¬øpor qu√© el agua cambi√≥ de color?, ¬øc√≥mo llega la basura?, ¬øqu√© consecuencias tiene? Un texto explicativo no se queda en ‚Äúc√≥mo se ve‚Äù, sino que busca causas y efectos. Por ejemplo: ‚ÄúEl agua se ve verdosa debido a que algunas aguas residuales llegan al cauce; por lo tanto, aumenta el riesgo de enfermedades‚Äù.

En un entorno como el ejido, las acequias o drenes pueden conectarse con el r√≠o. Si se tiran bolsas, botellas o restos de comida, esos residuos pueden ser arrastrados por la corriente. Adem√°s, si se derraman aceites o detergentes, el agua puede contaminarse aunque no se note de inmediato. En consecuencia, los peces pueden morir y el agua deja de ser √∫til para ciertas actividades.

Saber diferenciar descripci√≥n y explicaci√≥n ayuda a escribir mejor. La descripci√≥n hace que el lector ‚Äúvea‚Äù el lugar. La explicaci√≥n, en cambio, permite entender lo que sucede y proponer acciones para mejorar. Por lo tanto, ambos tipos de texto son importantes, pero cumplen funciones diferentes.`
          },
          act1:{ type:"mcq", title:"Actividad 1: ¬øDescripci√≥n o explicaci√≥n?",
            questions:[
              {q:"¬øQu√© parte corresponde a una DESCRIPCI√ìN?", options:[
                {t:"El r√≠o es angosto y suena fuerte al correr.", correct:true},{t:"El agua cambi√≥ de color debido a residuos.", correct:false},{t:"Por lo tanto, aumenta el riesgo de enfermedades.", correct:false}
              ]},
              {q:"¬øQu√© pregunta suele responder un texto EXPLICATIVO?", options:[
                {t:"¬øPor qu√© sucede?", correct:true},{t:"¬øQu√© tan bonito se ve?", correct:false},{t:"¬øQu√© color me gusta m√°s?", correct:false}
              ]},
              {q:"‚ÄúEn consecuencia, los peces pueden morir‚Äù es‚Ä¶", options:[
                {t:"Una consecuencia dentro de una explicaci√≥n.", correct:true},{t:"Una descripci√≥n con adjetivos.", correct:false},{t:"Una rima.", correct:false}
              ]},
              {q:"La diferencia principal es que la explicaci√≥n‚Ä¶", options:[
                {t:"da causas y efectos.", correct:true},{t:"solo enumera colores.", correct:false},{t:"no usa conectores.", correct:false}
              ]}
            ]
          },
          act2:{ type:"match", title:"Actividad 2: Relacionar columnas",
            prompt:"Relaciona cada enunciado con su tipo: DESCRIPCI√ìN o EXPLICACI√ìN.",
            left:[
              "El agua se ve verdosa y hay ramas en la orilla.",
              "El agua cambi√≥ debido a residuos; por lo tanto, hay riesgo de enfermedad.",
              "Se escuchan sonidos fuertes cuando el r√≠o corre.",
              "En consecuencia, los peces pueden morir si se contamina."
            ],
            right:["DESCRIPCI√ìN","EXPLICACI√ìN"],
            correct:[0,1,0,1]
          }
        },
        {
          shortName:"Fuentes de informaci√≥n",
          reading:{
            title:"Lectura: ¬øQu√© es una fuente de informaci√≥n?",
            text:`Cuando queremos escribir un texto explicativo, no basta con ‚Äúcreer‚Äù algo; necesitamos informaci√≥n confiable. Una fuente es el lugar de donde obtenemos datos o ideas. Hay fuentes impresas, como libros y enciclopedias; fuentes digitales, como p√°ginas educativas; y fuentes orales, como entrevistas a personas que saben del tema. Tambi√©n existe una fuente directa: observar lo que sucede en la comunidad.

Por ejemplo, si queremos explicar por qu√© se tapan las acequias, podemos consultar un libro de ciencias sobre el agua, leer un folleto de la junta de agua, entrevistar a un agricultor y observar el canal. Cada fuente aporta algo diferente. Un libro puede decir c√≥mo circula el agua; un folleto puede explicar reglas de cuidado; una entrevista puede contar experiencias reales; y la observaci√≥n puede mostrar la cantidad de basura o el nivel del agua.

Para usar las fuentes, conviene hacer una ficha. En ella escribimos el nombre de la fuente, qui√©n la hizo (autor), la fecha y las ideas principales. Tambi√©n podemos registrar palabras t√©cnicas, como ‚Äúsedimentos‚Äù, ‚Äúfiltrado‚Äù o ‚Äúcontaminantes‚Äù. As√≠ evitamos copiar sin entender y, en cambio, construimos un texto con nuestras palabras.

Por lo tanto, reunir informaci√≥n de varias fuentes ayuda a explicar mejor. Adem√°s, comparar fuentes permite verificar si una idea se repite o si hay diferencias. En consecuencia, el texto explicativo ser√° m√°s claro y m√°s confiable para quienes lo lean.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Uso de fuentes",
            questions:[
              {q:"Una fuente ORAL puede ser‚Ä¶", options:[
                {t:"Una entrevista a un agricultor.", correct:true},{t:"Una nube en el cielo.", correct:false},{t:"Un dibujo sin explicaci√≥n.", correct:false}
              ]},
              {q:"¬øPara qu√© sirve una ficha?", options:[
                {t:"Para registrar datos y no copiar sin entender.", correct:true},{t:"Para borrar la informaci√≥n.", correct:false},{t:"Para no leer ninguna fuente.", correct:false}
              ]},
              {q:"Una fuente directa es‚Ä¶", options:[
                {t:"Observar lo que pasa en la comunidad.", correct:true},{t:"Inventar datos.", correct:false},{t:"Adivinar.", correct:false}
              ]},
              {q:"Usar varias fuentes ayuda a‚Ä¶", options:[
                {t:"explicar mejor y verificar informaci√≥n.", correct:true},{t:"confundirse a prop√≥sito.", correct:false},{t:"evitar aprender.", correct:false}
              ]}
            ]
          },
          act2:{ type:"memory", title:"Actividad 2: Memorama (fuente ‚Üî ejemplo)",
            prompt:"Encuentra los pares correctos. Cuando completes, califica.",
            pairs:[
              ["ORAL","Entrevista a un agricultor"],
              ["IMPRESA","Libro de texto"],
              ["DIGITAL","P√°gina educativa"],
              ["DIRECTA","Observaci√≥n del canal"],
              ["FICHA","Registro de datos clave"],
              ["T√âCNICA","Palabra como ‚Äúsedimentos‚Äù"]
            ]
          }
        },
        {
          shortName:"Causa y consecuencia",
          reading:{
            title:"Lectura: ¬øPor qu√© se tapan las coladeras?",
            text:`En muchas comunidades, las coladeras o desag√ºes se tapan con facilidad. Una causa frecuente es tirar basura en la calle o en el canal. Bolsas, envolturas, hojas y botellas pueden ser arrastradas por el agua cuando llueve. Debido a eso, los residuos se juntan en las rejillas y impiden el paso del agua.

Otra causa es la tierra que baja desde terrenos sin pasto o con caminos de terracer√≠a. Cuando cae una lluvia fuerte, el agua arrastra el lodo y lo deposita cerca del desag√ºe. En consecuencia, aunque no haya basura, la coladera puede bloquearse por sedimentos. Adem√°s, algunas personas tiran aceite o grasa en el drenaje. Esa grasa se enfr√≠a, se endurece y se pega a las paredes de las tuber√≠as. Por lo tanto, el tubo se vuelve m√°s angosto y se tapa.

Cuando una coladera se tapa, ocurre una consecuencia importante: el agua se acumula y puede provocar charcos grandes o inundaciones peque√±as. Esto afecta el paso de las personas y puede da√±ar casas o escuelas. Tambi√©n se forman malos olores y pueden aparecer mosquitos. En consecuencia, un problema peque√±o puede volverse un problema de salud.

Para evitarlo, se recomienda no tirar basura, barrer la calle y colocar la basura en su lugar. Tambi√©n es √∫til limpiar rejillas y reportar puntos donde el agua se estanca. Por lo tanto, cuidar los desag√ºes es una acci√≥n que beneficia a toda la comunidad.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Conectores causales",
            questions:[
              {q:"¬øQu√© conector indica causa?", options:[{t:"Debido a", correct:true},{t:"Ayer", correct:false},{t:"Tal vez", correct:false}]},
              {q:"Una consecuencia de coladeras tapadas es‚Ä¶", options:[{t:"acumulaci√≥n de agua e inundaciones peque√±as.", correct:true},{t:"que el agua se vuelva invisible.", correct:false},{t:"que no llueva nunca.", correct:false}]},
              {q:"¬øQu√© puede tapar tuber√≠as aunque no haya basura?", options:[{t:"Grasa que se endurece y sedimentos.", correct:true},{t:"M√∫sica.", correct:false},{t:"Sombras.", correct:false}]},
              {q:"‚ÄúPor lo tanto‚Äù se usa para‚Ä¶", options:[{t:"concluir o mostrar consecuencia.", correct:true},{t:"cambiar de tema sin relaci√≥n.", correct:false},{t:"hacer una pregunta.", correct:false}]}
            ]
          },
          act2:{ type:"matchPairs", title:"Actividad 2: Relaciona (causa ‚Üî consecuencia)",
            prompt:"Une cada causa con su consecuencia.",
            pairs:[
              ["Tirar basura en la calle","Se tapan rejillas y no pasa el agua"],
              ["Lluvia arrastra lodo","Sedimentos bloquean la coladera"],
              ["Tirar grasa al drenaje","Se endurece y estrecha tuber√≠as"],
              ["Coladera tapada","Charcos/inundaci√≥n y malos olores"]
            ]
          }
        },
        {
          shortName:"Par√°frasis y cita",
          reading:{
            title:"Lectura: Copiar no es explicar",
            text:`Cuando escribimos un texto explicativo, podemos usar informaci√≥n de otras personas, pero debemos hacerlo de manera correcta. Copiar y pegar un p√°rrafo completo sin decir de d√≥nde viene no es una buena pr√°ctica. En cambio, podemos usar dos recursos: la cita textual y la par√°frasis.

Una cita textual es repetir exactamente las palabras de un autor. Para hacerlo, se usan comillas y se indica la fuente. Por ejemplo: ‚ÄúEl agua potable es aquella que no causa da√±o a la salud‚Äù (Folleto de Salud, 2024). Esto significa que estamos usando las mismas palabras de la fuente.

La par√°frasis es diferente: tomamos una idea y la escribimos con nuestras propias palabras sin cambiar el sentido. Por ejemplo, en lugar de copiar la frase anterior, podr√≠amos decir: El agua es potable cuando es segura para beber y no enferma a las personas. Aqu√≠ no usamos las mismas palabras, pero mantenemos la idea.

Tambi√©n es importante anotar los datos de la fuente: autor (si lo tiene), t√≠tulo, editorial o instituci√≥n, lugar y fecha, y p√°ginas si es un libro. Esto ayuda a que cualquiera pueda buscar la informaci√≥n y comprobarla. Por lo tanto, citar bien y parafrasear es parte de escribir textos confiables.

En consecuencia, cuando usamos fuentes con responsabilidad, aprendemos m√°s: leemos, comprendemos y construimos explicaciones claras con nuestras propias palabras.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Identifico cita y par√°frasis",
            questions:[
              {q:"¬øQu√© es una cita textual?", options:[{t:"Usar exactamente las palabras de la fuente y poner comillas.", correct:true},{t:"Inventar una frase.", correct:false},{t:"Cambiar el tema.", correct:false}]},
              {q:"¬øQu√© es par√°frasis?", options:[{t:"Explicar una idea con tus palabras sin cambiar el sentido.", correct:true},{t:"Copiar completo.", correct:false},{t:"Poner solo emojis.", correct:false}]},
              {q:"¬øQu√© dato ayuda a localizar una fuente?", options:[{t:"T√≠tulo y fecha.", correct:true},{t:"Color de la portada.", correct:false},{t:"Tu apodo.", correct:false}]},
              {q:"Citar bien sirve para‚Ä¶", options:[{t:"hacer textos confiables y verificables.", correct:true},{t:"evitar leer.", correct:false},{t:"hacer trampa.", correct:false}]}
            ]
          },
          act2:{ type:"hangman", title:"Actividad 2: Ahorcado (conceptos clave)",
            prompt:"Adivina las palabras relacionadas con fuentes y escritura confiable.",
            words:["CITA","PARAFRASIS","AUTOR","TITULO","EDITORIAL","FECHA","PAGINAS","FUENTE"]
          }
        }
      ],

      "6": [
        {
          shortName:"Leo textos variados",
          reading:{
            title:"Lectura: ¬øPor qu√© es importante cuidar el agua potable?",
            text:`El agua potable es el agua que puede beberse sin causar da√±o a la salud. Sin embargo, para que el agua sea segura debe pasar por un proceso de potabilizaci√≥n. Cuando el agua llega directamente de r√≠os, presas o pozos, puede contener tierra, restos de plantas, bacterias y sustancias que no se ven a simple vista. Si una persona consume agua contaminada, puede presentar enfermedades gastrointestinales, deshidrataci√≥n e infecciones.

La potabilizaci√≥n suele incluir varias etapas. Primero, se retiran los residuos grandes con rejillas o filtros. Despu√©s, en la etapa de sedimentaci√≥n, las part√≠culas pesadas se depositan en el fondo. M√°s adelante se aplica un filtrado m√°s fino para reducir la turbiedad, es decir, lo ‚Äúnublada‚Äù que se ve el agua. Finalmente, se desinfecta. En muchos lugares se usa cloro en cantidades controladas, porque elimina microorganismos que pueden causar enfermedades. En otros casos se emplea luz ultravioleta u ozono como m√©todos complementarios.

Cuidar el agua potable tambi√©n significa evitar que se contamine antes de llegar a las casas. Tirar basura a las acequias o drenes, verter aceites al suelo o permitir que los animales ensucien los canales puede llevar contaminantes a las fuentes de agua. Adem√°s, cuando hay fugas en tuber√≠as, el agua puede mezclarse con tierra o aguas sucias, y aumenta el riesgo de contaminaci√≥n.

Por lo tanto, el cuidado del agua potable requiere acciones colectivas y personales: usarla con responsabilidad, mantener limpios los entornos, reportar fugas, y almacenar el agua en recipientes limpios y tapados. En consecuencia, al proteger el agua potable, se protege la salud de la comunidad.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Comprensi√≥n del texto",
            questions:[
              {q:"¬øCu√°l es el prop√≥sito principal del texto?", options:[{t:"Explicar qu√© es el agua potable y por qu√© debe cuidarse.", correct:true},{t:"Contar una historia personal.", correct:false},{t:"Dar opiniones sin datos.", correct:false}]},
              {q:"¬øQu√© ocurre en la sedimentaci√≥n?", options:[{t:"Las part√≠culas pesadas se depositan en el fondo.", correct:true},{t:"Se agrega az√∫car.", correct:false},{t:"Se corta el flujo del r√≠o.", correct:false}]},
              {q:"Una consecuencia de consumir agua contaminada es‚Ä¶", options:[{t:"Enfermedades gastrointestinales.", correct:true},{t:"Aprender m√°s r√°pido.", correct:false},{t:"Cambiar de color.", correct:false}]},
              {q:"Verdadero o falso: el texto menciona m√°s de un m√©todo de desinfecci√≥n.", options:[{t:"Verdadero", correct:true},{t:"Falso", correct:false}]}
            ]
          },
          act2:{ type:"matchPairs", title:"Actividad 2: Relaciona (etapa ‚Üî qu√© ocurre)",
            prompt:"Une cada etapa de potabilizaci√≥n con lo que sucede.",
            pairs:[
              ["Filtrado inicial","Se retiran residuos grandes con rejillas o filtros"],
              ["Sedimentaci√≥n","Las part√≠culas pesadas se depositan en el fondo"],
              ["Filtrado fino","Se reduce la turbiedad del agua"],
              ["Desinfecci√≥n","Se eliminan microorganismos (cloro/UV/ozono)"]
            ]
          }
        },
        {
          shortName:"Resumen e ideas",
          reading:{
            title:"Lectura: ¬øC√≥mo elegir ideas principales?",
            text:`Un texto explicativo suele tener muchas ideas, pero no todas tienen el mismo peso. Las ideas principales son las que sostienen el tema central; las secundarias ayudan con ejemplos, detalles o datos. Para identificar ideas principales, conviene preguntarse: ¬øde qu√© trata el texto en general?, ¬øqu√© informaci√≥n se repite o se relaciona con todo?

Por ejemplo, si un texto explica la propagaci√≥n de enfermedades respiratorias, una idea principal puede ser que los virus viajan en gotas al hablar, toser o estornudar. En cambio, un dato secundario ser√≠a el n√∫mero exacto de horas que un virus puede permanecer en una superficie, porque ese dato apoya pero no es el coraz√≥n del texto.

Una t√©cnica √∫til es subrayar frases que respondan: ¬øqu√© es?, ¬øc√≥mo funciona?, ¬øpor qu√© sucede?, ¬øqu√© consecuencias tiene? Despu√©s, se agrupan esas frases en 3 a 5 puntos. Con esos puntos se puede construir un resumen. Un resumen no copia el texto: lo reconstruye con palabras propias, manteniendo solo lo esencial.

Tambi√©n es importante cuidar la secuencia: primero se presenta el tema, luego se explican causas o pasos y finalmente se cierra con una conclusi√≥n. Por lo tanto, un buen resumen es breve, claro y ordenado. En consecuencia, aprender a identificar ideas principales permite comprender mejor y escribir textos explicativos m√°s completos.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Ideas principales",
            questions:[
              {q:"Las ideas principales son‚Ä¶", options:[{t:"las que sostienen el tema central.", correct:true},{t:"solo ejemplos.", correct:false},{t:"palabras al azar.", correct:false}]},
              {q:"Un dato secundario es‚Ä¶", options:[{t:"un detalle que apoya, pero no es el centro.", correct:true},{t:"la idea m√°s importante.", correct:false},{t:"algo inventado.", correct:false}]},
              {q:"¬øQu√© hace un resumen?", options:[{t:"Reconstruye lo esencial con palabras propias.", correct:true},{t:"Copia completo.", correct:false},{t:"Solo dibujos.", correct:false}]},
              {q:"¬øQu√© ayuda a mantener orden?", options:[{t:"Seguir secuencia inicio-desarrollo-cierre.", correct:true},{t:"Cambiar de tema.", correct:false},{t:"No usar puntos.", correct:false}]}
            ]
          },
          act2:{ type:"order", title:"Actividad 2: L√≠nea de tiempo (estructura del resumen)",
            prompt:"Ordena los elementos para construir un resumen claro.",
            items:[
              "Presento el tema general del texto.",
              "Selecciono ideas principales (3 a 5).",
              "Elimino detalles secundarios repetidos.",
              "Redacto con mis palabras (sin copiar).",
              "Cierro con una conclusi√≥n breve."
            ],
            correctOrder:[0,1,2,3,4]
          }
        },
        {
          shortName:"Causa‚Äìconsecuencia",
          reading:{
            title:"Lectura: ¬øPor qu√© aumenta la basura en la comunidad?",
            text:`En algunas comunidades, la cantidad de basura en calles, canales o terrenos bald√≠os aumenta por varias causas. Una causa com√∫n es la falta de separaci√≥n de residuos. Cuando se mezcla comida con pl√°stico y vidrio, es m√°s dif√≠cil reciclar y la basura se acumula. Adem√°s, si no hay botes suficientes o si est√°n lejos, algunas personas tiran residuos en cualquier lugar.

Otra causa es el consumo de productos con demasiados empaques. Al comprar botanas, refrescos o comida para llevar, se generan envolturas, bolsas y botellas. Por lo tanto, a mayor consumo de empaques, mayor cantidad de basura. Tambi√©n influye la falta de h√°bitos: si no se barre el frente de la casa o si se deja la basura suelta, el viento la arrastra hacia los drenes.

Las consecuencias se notan r√°pido: se tapan coladeras, aparecen malos olores y se forman charcos. En consecuencia, aumentan mosquitos y puede haber problemas de salud. Adem√°s, la basura puede llegar al r√≠o y afectar animales y plantas.

Para disminuir el problema, funcionan acciones simples: separar residuos, reusar botellas, poner la basura en bolsas cerradas, y organizar jornadas de limpieza. Debido a esas acciones, el entorno mejora y la comunidad se vuelve m√°s segura y saludable.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Identifico causas y consecuencias",
            questions:[
              {q:"Una causa mencionada es‚Ä¶", options:[{t:"Falta de separaci√≥n de residuos.", correct:true},{t:"Que los √°rboles hablen.", correct:false},{t:"Que el cielo sea azul.", correct:false}]},
              {q:"Una consecuencia mencionada es‚Ä¶", options:[{t:"Se tapan coladeras y hay malos olores.", correct:true},{t:"Se aprende solo.", correct:false},{t:"Las bolsas desaparecen.", correct:false}]},
              {q:"‚ÄúPor lo tanto‚Äù indica‚Ä¶", options:[{t:"conclusi√≥n o consecuencia.", correct:true},{t:"color.", correct:false},{t:"pregunta.", correct:false}]},
              {q:"‚ÄúDebido a esas acciones‚Äù se usa para‚Ä¶", options:[{t:"explicar causa.", correct:true},{t:"negar.", correct:false},{t:"cambiar idioma.", correct:false}]}
            ]
          },
          act2:{ type:"matchPairs", title:"Actividad 2: Relaciona (causa ‚Üî consecuencia)",
            prompt:"Une la causa con la consecuencia correcta.",
            pairs:[
              ["Mezclar org√°nicos con pl√°sticos","Se dificulta reciclar y se acumula basura"],
              ["Comprar productos con mucho empaque","Aumentan envolturas y botellas"],
              ["Basura suelta con viento","Residuos llegan a drenes y canales"],
              ["Coladeras tapadas","Charcos, malos olores y mosquitos"]
            ]
          }
        },
        {
          shortName:"Orden temporal",
          reading:{
            title:"Lectura: ¬øC√≥mo se hace composta?",
            text:`La composta es un abono natural que se obtiene al descomponer restos org√°nicos, como c√°scaras de fruta, hojas secas y residuos de verduras. Primero, se elige un lugar ventilado y se coloca una base de ramas o material seco. Despu√©s, se agregan capas: una capa de material ‚Äúverde‚Äù (c√°scaras y restos de comida sin grasa) y luego una capa de material ‚Äúcaf√©‚Äù (hojas secas, aserr√≠n o cart√≥n). Posteriormente, se a√±ade un poco de tierra para ayudar a los microorganismos que realizan la descomposici√≥n.

Durante el proceso, es importante mantener la composta h√∫meda, pero no empapada. Si hay demasiada agua, puede oler mal; si est√° muy seca, se tarda m√°s en descomponerse. Luego, cada cierto tiempo se mezcla la composta para que entre aire. Esa mezcla permite que los organismos trabajen mejor y evita malos olores.

Finalmente, despu√©s de varias semanas o meses, el material cambia: ya no se distinguen las c√°scaras y todo se vuelve oscuro, suelto y con olor a tierra. En consecuencia, se obtiene un abono que mejora el suelo y ayuda a las plantas a crecer. Por lo tanto, hacer composta reduce basura org√°nica y aprovecha residuos que normalmente se tirar√≠an.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Conectores temporales",
            questions:[
              {q:"¬øQu√© conector indica inicio?", options:[{t:"Primero", correct:true},{t:"Nunca", correct:false},{t:"Tal vez", correct:false}]},
              {q:"¬øQu√© se hace ‚Äúluego‚Äù?", options:[{t:"Mezclar para que entre aire.", correct:true},{t:"Tirar todo al drenaje.", correct:false},{t:"Pintar c√°scaras.", correct:false}]},
              {q:"‚ÄúFinalmente‚Äù indica‚Ä¶", options:[{t:"Cierre del proceso y resultado.", correct:true},{t:"Una causa.", correct:false},{t:"Un color.", correct:false}]},
              {q:"La composta ayuda porque‚Ä¶", options:[{t:"mejora el suelo y reduce basura org√°nica.", correct:true},{t:"convierte pl√°stico en oro.", correct:false},{t:"evita plantas.", correct:false}]}
            ]
          },
          act2:{ type:"order", title:"Actividad 2: L√≠nea de tiempo (pasos de la composta)",
            prompt:"Ordena los pasos del proceso seg√∫n la lectura.",
            items:[
              "Elegir un lugar ventilado y poner base de material seco.",
              "Agregar capa verde y capa caf√©.",
              "A√±adir un poco de tierra.",
              "Mantener humedad sin empapar.",
              "Mezclar cada cierto tiempo para que entre aire.",
              "Esperar hasta que sea oscuro y con olor a tierra."
            ],
            correctOrder:[0,1,2,3,4,5]
          }
        },
        {
          shortName:"Palabras t√©cnicas",
          reading:{
            title:"Lectura: Vocabulario t√©cnico en salud",
            text:`En los textos explicativos, las palabras t√©cnicas ayudan a decir con precisi√≥n lo que ocurre. Por ejemplo, cuando hablamos de enfermedades respiratorias, usamos t√©rminos como ‚Äútransmisi√≥n‚Äù, ‚Äúmicroorganismo‚Äù, ‚Äús√≠ntomas‚Äù y ‚Äúprevenci√≥n‚Äù. Un microorganismo es un ser muy peque√±o que no se puede ver a simple vista, como ciertas bacterias o virus. La transmisi√≥n es la forma en que esos microorganismos pasan de una persona a otra.

Los s√≠ntomas son se√±ales que aparecen cuando una persona est√° enferma: fiebre, tos, dolor de garganta o cansancio. La prevenci√≥n son acciones que reducen el riesgo de enfermarse. Por lo tanto, lavarse las manos, ventilar el sal√≥n y cubrirse al toser son medidas de prevenci√≥n. En consecuencia, disminuye la probabilidad de que los microorganismos se propaguen.

Otro t√©rmino importante es ‚Äúdesinfecci√≥n‚Äù. Desinfectar significa eliminar microorganismos de una superficie usando productos adecuados. Tambi√©n se usa la palabra ‚Äúcontagio‚Äù, que se refiere al paso de una enfermedad entre personas. Debido a que los virus viajan en gotas al hablar o estornudar, se recomienda mantener higiene y no compartir botellas.

En resumen, aprender palabras t√©cnicas no es memorizar por memorizar; es comprender mejor las explicaciones. Adem√°s, usar estas palabras permite escribir textos claros y exactos para compartir informaci√≥n con la comunidad.`
          },
          act1:{ type:"mcq", title:"Actividad 1: Vocabulario t√©cnico",
            questions:[
              {q:"‚ÄúTransmisi√≥n‚Äù significa‚Ä¶", options:[{t:"c√≥mo pasa un microorganismo entre personas.", correct:true},{t:"un tipo de comida.", correct:false},{t:"un color.", correct:false}]},
              {q:"Un ‚Äúmicroorganismo‚Äù es‚Ä¶", options:[{t:"ser muy peque√±o que no se ve a simple vista.", correct:true},{t:"animal enorme.", correct:false},{t:"instrumento musical.", correct:false}]},
              {q:"‚ÄúPrevenci√≥n‚Äù son‚Ä¶", options:[{t:"acciones para reducir el riesgo de enfermarse.", correct:true},{t:"acciones para empeorar.", correct:false},{t:"solo descansar.", correct:false}]},
              {q:"‚ÄúDesinfecci√≥n‚Äù significa‚Ä¶", options:[{t:"eliminar microorganismos de una superficie.", correct:true},{t:"hacer una fiesta.", correct:false},{t:"pintar una pared.", correct:false}]},
            ]
          },
          act2:{ type:"hangman", title:"Actividad 2: Ahorcado (palabras t√©cnicas)",
            prompt:"Adivina 5 palabras t√©cnicas. Cada palabra vale 1 punto.",
            words:["TRANSMISION","MICROORGANISMO","SINTOMAS","PREVENCION","DESINFECCION","CONTAGIO"]
          }
        }
      ]
    };

    /* ===================== STATE ===================== */
    const state = {
      grade:null, pdaIndex:null, studentName:"",
      attempts:{}, scores:{}, badges:new Set(),
      game:{}
    };

    const $ = (id)=>document.getElementById(id);

    function safeText(s){ return (s||"").replace(/[<>&]/g, c=>({ "<":"&lt;", ">":"&gt;", "&":"&amp;" }[c])); }
    function keyAct(grade,pdaNum,act){ return `${grade}-${pdaNum}-${act}`; }
    function getAttempts(k){ return state.attempts[k] ?? 0; }
    function incAttempts(k){ state.attempts[k] = getAttempts(k) + 1; }
    function setScore(k,score,max){ state.scores[k] = {score, max}; }
    function sumScoresForGrade(grade){
      let total=0, max=0;
      Object.entries(state.scores).forEach(([k,v])=>{ if(k.startsWith(grade+"-")){ total+=v.score; max+=v.max; }});
      return {total, max, pct: max? Math.round((total/max)*100):0};
    }
    function markBadge(code){ state.badges.add(code); }

    /* ===================== VOICE ===================== */
    function speak(text){
      try{
        speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        u.lang="es-MX"; u.rate=1.0;
        speechSynthesis.speak(u);
      }catch(e){}
    }
    function speakCover(){
      speak("Bienvenido. Elige tu grado. Lee la lectura y realiza actividades din√°micas: relacionar, ordenar, ahorcado, sopa de letras y memorama. Recuerda: solo dos intentos por actividad.");
    }
    function speakCurrent(){
      const name = state.studentName ? `Hola ${state.studentName}. ` : "Hola. ";
      const g = state.grade ? `Est√°s en ${state.grade}o grado. ` : "";
      const p = (state.pdaIndex!=null) ? `PDA ${state.pdaIndex+1}. ` : "";
      speak(name+g+p+"Lee y luego realiza las actividades. Al final puedes imprimir.");
    }

    /* ===================== NAV ===================== */
    function goHome(){
      $("app").style.display="none";
      $("cover").style.display="flex";
      state.grade=null; state.pdaIndex=null;
      $("topSub").textContent="Fase 5 ¬∑ Selecciona un PDA";
      $("pillGrade").textContent="‚Äî";
      buildMenu();
    }
    function startGrade(grade){
      state.grade=grade; state.pdaIndex=0;
      $("cover").style.display="none";
      $("app").style.display="block";
      $("pillGrade").textContent=grade+"¬∞";
      $("topSub").textContent=`Fase 5 ¬∑ ${grade}¬∞ grado ¬∑ ${CONTENT_TITLE}`;
      buildMenu();
      loadPDA(0);
      markBadge(grade==="6" ? "üöÄ Explorador 6¬∞" : "üöÄ Explorador 5¬∞");
      refreshTopPills();
    }
    function setName(name){
      state.studentName=(name||"").trim();
      refreshTopPills();
    }
    function refreshTopPills(){
      $("pillName").textContent=state.studentName||"Sin nombre";
      $("pillGrade").textContent=state.grade?(state.grade+"¬∞"):"‚Äî";
    }

    function buildMenu(){
      const menu=$("pdaMenu");
      menu.innerHTML="";
      if(!state.grade){
        menu.innerHTML=`<div class="small">Primero elige grado en la portada.</div>`;
        return;
      }
      const list=PDAS[state.grade];
      list.forEach((pda,idx)=>{
        const btn=document.createElement("button");
        btn.className="menuBtn"+(state.pdaIndex===idx?" active":"");
        btn.onclick=()=>loadPDA(idx);
        btn.innerHTML=`
          <div class="left">
            <div class="badge">${idx+1}</div>
            <div>
              <div class="t">PDA ${idx+1} ¬∑ ${safeText(MODULES[state.grade][idx].shortName)}</div>
              <div class="s">${safeText(pda)}</div>
            </div>
          </div>
          <div class="right">‚ûú</div>
        `;
        menu.appendChild(btn);
      });

      const s=sumScoresForGrade(state.grade);
      const res=document.createElement("div");
      res.className="card"; res.style.marginTop="10px";
      res.innerHTML=`
        <h3>üìà Progreso</h3>
        <p class="small">Puntaje acumulado del grado: <b>${s.total}/${s.max}</b> (${s.pct}%).</p>
        <div class="metaLine">
          <span class="chip"><span class="dot"></span> Intentos por actividad: 2</span>
          <span class="chip"><span class="dot"></span> Actividades din√°micas</span>
        </div>
      `;
      menu.appendChild(res);
    }

    /* ===================== PDA RENDER ===================== */
    function attemptPillHTML(grade,pdaNum,act){
      const k=keyAct(grade,pdaNum,act);
      const used=getAttempts(k);
      const left=Math.max(0,2-used);
      return `<span class="attempts">üîÅ Intentos: <b>${used}</b>/2 ¬∑ Restan <b>${left}</b></span>`;
    }

    function loadPDA(idx){
      state.pdaIndex=idx;
      buildMenu();

      const grade=state.grade;
      const pdaNum=idx+1;
      const pdaText=PDAS[grade][idx];
      const mod=MODULES[grade][idx];

      $("contentArea").innerHTML=`
        <div class="card">
          <h3>üß≠ ${CONTENT_TITLE}</h3>
          <p><b>Grado:</b> ${grade}¬∞ &nbsp;|&nbsp; <b>PDA ${pdaNum}:</b> ${safeText(pdaText)}</p>
          <div class="metaLine">
            <span class="chip"><span class="dot"></span> 2 actividades</span>
            <span class="chip"><span class="dot"></span> 2 intentos</span>
            <span class="chip"><span class="dot"></span> Autoevaluable</span>
          </div>
        </div>

        <div class="card">
          <h3>üìñ ${safeText(mod.reading.title)}</h3>
          <div class="reading">
            <div class="k">Lectura</div>
            ${safeText(mod.reading.text).replace(/\n/g,"<br>")}
          </div>
        </div>

        <div class="activity" id="act1"></div>
        <div class="activity" id="act2"></div>

        <div class="card">
          <h3>üßæ Resultados del PDA</h3>
          <div class="resultsGrid" id="pdaResultsGrid"></div>
          <div class="divider"></div>
          <div class="row no-print">
            <button class="btn btn-primary" onclick="printResults()">üñ®Ô∏è Imprimir</button>
          </div>
          <div id="pdaBadgeLine" class="small"></div>
        </div>
      `;

      renderActivity(grade,pdaNum,1,mod.act1);
      renderActivity(grade,pdaNum,2,mod.act2);
      renderPdaResults(grade,pdaNum);
    }

    function setStatus(actKey,type,msg){
      const el=document.getElementById("status_"+actKey);
      if(!el) return;
      el.className="status "+type;
      const ico = type==="ok" ? "‚úì" : type==="bad" ? "!" : type==="warn" ? "!" : "i";
      el.innerHTML=`<div class="ico">${ico}</div><div>${msg}</div>`;
      el.querySelector(".ico").style.background =
        type==="ok" ? "var(--ok)" :
        type==="bad" ? "var(--bad)" :
        type==="warn" ? "var(--warn)" : "var(--red)";
    }

    function renderActivity(grade,pdaNum,n,cfg){
      const id=(n===1)?"act1":"act2";
      const actKey=keyAct(grade,pdaNum,(n===1)?"A1":"A2");
      const used=getAttempts(actKey);
      const locked=used>=2;

      if(cfg.type==="mcq"){
        const htmlQs = cfg.questions.map((qq,i)=>{
          const name=`g${grade}p${pdaNum}a${n}q${i}`;
          const opts=qq.options.map(op=>`
            <label class="opt">
              <input type="radio" name="${name}" value="${op.correct?1:0}" ${locked?"disabled":""}/>
              ${safeText(op.t)}
            </label>
          `).join("");
          return `
            <div class="q">
              <div class="qt">${i+1}) ${safeText(qq.q)}</div>
              <div class="options">${opts}</div>
            </div>
          `;
        }).join("");

        document.getElementById(id).innerHTML=`
          <div class="head">
            <div class="title">üß† ${safeText(cfg.title)}</div>
            ${attemptPillHTML(grade,pdaNum,(n===1)?"A1":"A2")}
          </div>
          <div class="small">Responde y pulsa <b>Calificar</b>.</div>
          ${htmlQs}
          <div class="row no-print">
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="gradeMCQ('${grade}',${pdaNum},${n})">‚úÖ Calificar</button>
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="clearMCQ('${grade}',${pdaNum},${n})">üßπ Borrar</button>
          </div>
          <div id="status_${actKey}" class="status info">
            <div class="ico">i</div><div>Completa todas las preguntas.</div>
          </div>
        `;
        return;
      }

      // Los dem√°s tipos (match/order/hangman/wordsearch/memory) se renderizan en la PARTE 2.
      renderGameActivity(grade,pdaNum,n,cfg,locked);
    }

    function gradeMCQ(grade,pdaNum,actN){
      const actKey=keyAct(grade,pdaNum,(actN===1)?"A1":"A2");
      if(getAttempts(actKey)>=2) return;
      const cfg=MODULES[grade][pdaNum-1][(actN===1)?"act1":"act2"];
      const qs=cfg.questions;
      let score=0;
      for(let i=0;i<qs.length;i++){
        const name=`g${grade}p${pdaNum}a${actN}q${i}`;
        const checked=document.querySelector(`input[name="${name}"]:checked`);
        if(!checked){ setStatus(actKey,"warn","Completa todas las preguntas antes de calificar."); return; }
        score += parseInt(checked.value,10);
      }
      const max=qs.length;
      incAttempts(actKey);
      setScore(actKey,score,max);
      if(score===max){ setStatus(actKey,"ok",`¬°Excelente! ${score}/${max}`); markBadge("üß† Lectura experta"); }
      else if(score>=Math.ceil(max*0.75)) setStatus(actKey,"ok",`¬°Muy bien! ${score}/${max}`);
      else setStatus(actKey,"bad",`Puntaje: ${score}/${max}. Relee y vuelve a intentar.`);
      renderActivity(grade,pdaNum,actN,cfg);
      renderPdaResults(grade,pdaNum);
      buildMenu();
    }
    function clearMCQ(grade,pdaNum,actN){
      const cfg=MODULES[grade][pdaNum-1][(actN===1)?"act1":"act2"];
      for(let i=0;i<cfg.questions.length;i++){
        const name=`g${grade}p${pdaNum}a${actN}q${i}`;
        document.querySelectorAll(`input[name="${name}"]`).forEach(r=>r.checked=false);
      }
    }

    function renderPdaResults(grade,pdaNum){
      const grid=document.getElementById("pdaResultsGrid");
      if(!grid) return;
      const a1=state.scores[keyAct(grade,pdaNum,"A1")]||{score:0,max:0};
      const a2=state.scores[keyAct(grade,pdaNum,"A2")]||{score:0,max:0};
      const total=a1.score+a2.score;
      const max=a1.max+a2.max;
      const pct=max?Math.round((total/max)*100):0;

      const a1Label=a1.max?`${a1.score}/${a1.max}`:"‚Äî";
      const a2Label=a2.max?`${a2.score}/${a2.max}`:"‚Äî";

      grid.innerHTML=`
        <div class="resultPill ${a1.max && a1.score < Math.ceil(a1.max*0.6) ? "bad":""}">
          <span>Actividad 1</span><span class="v">${a1Label}</span>
        </div>
        <div class="resultPill ${a2.max && a2.score < Math.ceil(a2.max*0.6) ? "bad":""}">
          <span>Actividad 2</span><span class="v">${a2Label}</span>
        </div>
        <div class="resultPill ${max && pct < 60 ? "bad":""}">
          <span>Total PDA</span><span class="v">${max?(total+"/"+max+" ("+pct+"%)"):"‚Äî"}</span>
        </div>
      `;

      const badgeLine=document.getElementById("pdaBadgeLine");
      if(badgeLine){
        const badges=Array.from(state.badges);
        badgeLine.innerHTML=badges.length ? `Logros: <b>${badges.join(" ¬∑ ")}</b>` : `Logros: <b>(a√∫n no)</b>`;
      }
    }

    function printResults(){ window.print(); }

    /* ===================== INIT ===================== */
    (function init(){
      buildMenu();
      refreshTopPills();
    })();
  </script>
  <script>
    /* =========================================================
      MOTOR DE JUEGOS (Act2): match, matchPairs, order, hangman,
      wordsearch, memory ‚Äî con 2 intentos y autoevaluaci√≥n
    ========================================================= */

    function renderGameActivity(grade,pdaNum,n,cfg,locked){
      const id=(n===1)?"act1":"act2";
      const actKey=keyAct(grade,pdaNum,(n===1)?"A1":"A2");
      const box = document.getElementById(id);

      const header = `
        <div class="head">
          <div class="title">üéÆ ${safeText(cfg.title)}</div>
          ${attemptPillHTML(grade,pdaNum,(n===1)?"A1":"A2")}
        </div>
        <div class="small">${safeText(cfg.prompt||"")}</div>
      `;

      if(cfg.type==="match"){
        // left items -> choose a category from right (2 options). score by correct array indexes.
        const gameId=`m_${grade}_${pdaNum}_${n}`;
        state.game[gameId] = state.game[gameId] || { sel: Array(cfg.left.length).fill(null) };

        const rightHTML = cfg.right.map((r,idx)=>`
          <button class="chipBtn ${locked?'btn-disabled':''}" onclick="matchPickRight('${gameId}',${idx})">${safeText(r)}</button>
        `).join("");

        const leftHTML = cfg.left.map((l,i)=>{
          const picked = state.game[gameId].sel[i];
          const label = picked==null ? "‚Äî" : cfg.right[picked];
          return `
            <div class="pairRow">
              <div style="flex:1"><b>${safeText(l)}</b></div>
              <span class="miniTag">${safeText(label)}</span>
              <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="matchAssign('${gameId}',${i})">Asignar</button>
            </div>
          `;
        }).join("");

        box.innerHTML = `
          ${header}
          <div class="gameGrid cols2">
            <div class="box">
              <h4>Columna A</h4>
              <div>${leftHTML}</div>
              <div class="hint">1) Elige una etiqueta en Columna B. 2) Pulsa ‚ÄúAsignar‚Äù en la fila.</div>
            </div>
            <div class="box">
              <h4>Columna B</h4>
              <div class="options">${rightHTML}</div>
              <div class="hint">Etiqueta seleccionada: <b id="${gameId}_pick">‚Äî</b></div>
            </div>
          </div>

          <div class="row no-print">
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="gradeMATCH('${grade}',${pdaNum},${n},'${gameId}')">‚úÖ Calificar</button>
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="resetMATCH('${gameId}',${cfg.left.length})">üßπ Reiniciar</button>
          </div>

          <div id="status_${actKey}" class="status info"><div class="ico">i</div><div>Asigna todas las filas y califica.</div></div>
        `;
        updateMatchPickLabel(gameId);
        return;
      }

      if(cfg.type==="matchPairs"){
        // drag a from left into right dropzones (pair mapping exact)
        const gameId=`mp_${grade}_${pdaNum}_${n}`;
        state.game[gameId] = state.game[gameId] || { placed: Array(cfg.pairs.length).fill(null) };

        const leftItems = cfg.pairs.map((p,i)=>({id:i, text:p[0]}));
        const rightItems = cfg.pairs.map((p,i)=>({id:i, text:p[1]}));

        // shuffle left display only
        const shuffledLeft = leftItems.map(x=>({x, r:Math.random()})).sort((a,b)=>a.r-b.r).map(o=>o.x);

        const leftHTML = shuffledLeft.map(it=>`
          <div class="opt draggable ${locked?'btn-disabled':''}" draggable="${locked?'false':'true'}" data-did="${it.id}" ondragstart="dragStart(event,'${gameId}')">
            ‚ò∞ ${safeText(it.text)}
          </div>
        `).join("");

        const rightHTML = rightItems.map((it,idx)=>{
          const placedId = state.game[gameId].placed[idx];
          const placedText = placedId==null ? "" : cfg.pairs[placedId][0];
          const filled = placedId==null ? "" : "filled";
          return `
            <div class="q">
              <div class="qt">${safeText(it.text)}</div>
              <div class="dropZone ${filled}" ondragover="event.preventDefault()" ondrop="dropOn(event,'${gameId}',${idx})">
                ${placedText ? `<b>${safeText(placedText)}</b> <span class="miniTag" style="margin-left:8px">Asignado</span>` : `<span class="small">Suelta aqu√≠‚Ä¶</span>`}
              </div>
              <div class="row no-print" style="margin-top:6px">
                <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="clearDrop('${gameId}',${idx})">Quitar</button>
              </div>
            </div>
          `;
        }).join("");

        box.innerHTML = `
          ${header}
          <div class="gameGrid cols2">
            <div class="box">
              <h4>Causas (arrastra)</h4>
              <div class="options" id="${gameId}_left">${leftHTML}</div>
              <div class="hint">Arrastra una causa y su√©ltala en la consecuencia correcta.</div>
            </div>
            <div class="box">
              <h4>Consecuencias (suelta)</h4>
              ${rightHTML}
            </div>
          </div>

          <div class="row no-print">
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="gradeMATCHPAIRS('${grade}',${pdaNum},${n},'${gameId}')">‚úÖ Calificar</button>
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="resetMATCHPAIRS('${gameId}',${cfg.pairs.length})">üßπ Reiniciar</button>
          </div>

          <div id="status_${actKey}" class="status info"><div class="ico">i</div><div>Completa todas las parejas y califica.</div></div>
        `;

        if(!locked) wireLeftDrag(gameId);
        return;
      }

      if(cfg.type==="order"){
        const gameId=`o_${grade}_${pdaNum}_${n}`;
        const items = cfg.items.map((t,i)=>({t,i}));
        const shuffled = items.map(x=>({x, r:Math.random()})).sort((a,b)=>a.r-b.r).map(o=>o.x);

        const listId=`${gameId}_list`;
        box.innerHTML = `
          ${header}
          <div class="q">
            <div class="qt">Arrastra para ordenar:</div>
            <div id="${listId}" class="options" style="gap:8px">
              ${shuffled.map(it=>`
                <div class="opt draggable ${locked?'btn-disabled':''}" draggable="${locked?'false':'true'}" data-oid="${it.i}">
                  ‚ò∞ ${safeText(it.t)}
                </div>
              `).join("")}
            </div>
            <div class="hint">Tip: piensa en conectores como ‚Äúprimero, despu√©s, finalmente‚Äù.</div>
          </div>

          <div class="row no-print">
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="gradeORDER('${grade}',${pdaNum},${n},'${listId}')">‚úÖ Calificar</button>
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="shuffleORDER('${listId}')">üîÄ Revolver</button>
          </div>

          <div id="status_${actKey}" class="status info"><div class="ico">i</div><div>Ordena y califica.</div></div>
        `;
        if(!locked) enableDragSort(listId);
        return;
      }

      if(cfg.type==="hangman"){
        const gameId=`h_${grade}_${pdaNum}_${n}`;
        if(!state.game[gameId]){
          state.game[gameId] = initHangman(cfg.words);
        }
        const g = state.game[gameId];

        const wordView = g.current.split("").map(ch=>{
          if(ch===" ") return " ";
          return g.revealed.has(ch) ? ch : "_";
        }).join(" ");

        box.innerHTML = `
          ${header}
          <div class="q">
            <div class="qt">Adivina la palabra (${g.index+1}/${g.targets.length})</div>
            <div class="hangWord">${safeText(wordView)}</div>
            <div class="metaLine" style="margin-top:10px">
              <span class="chip"><span class="dot"></span> Errores: <b>${g.misses}</b> / 6</span>
              <span class="chip"><span class="dot"></span> Palabras correctas: <b>${g.wins}</b></span>
            </div>
            <div class="kbd">
              ${hangmanKeyboardHTML(gameId, locked)}
            </div>
            <div class="row no-print">
              <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="nextHangWord('${gameId}')">‚è≠Ô∏è Siguiente palabra</button>
              <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="resetHangman('${gameId}')">üßπ Reiniciar</button>
            </div>
          </div>

          <div class="row no-print">
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="gradeHANGMAN('${grade}',${pdaNum},${n},'${gameId}')">‚úÖ Calificar</button>
          </div>

          <div id="status_${actKey}" class="status info"><div class="ico">i</div><div>Juega y luego califica. Tu puntaje ser√° ‚Äúpalabras correctas‚Äù.</div></div>
        `;
        return;
      }

      if(cfg.type==="wordsearch"){
        const gameId=`ws_${grade}_${pdaNum}_${n}`;
        if(!state.game[gameId]){
          state.game[gameId] = initWordSearch(cfg.words, cfg.gridSize || 10);
        }
        const g = state.game[gameId];

        box.innerHTML = `
          ${header}
          <div class="q">
            <div class="qt">Tablero</div>
            <div class="wsGrid" id="${gameId}_grid" style="grid-template-columns:repeat(${g.size}, 34px)">
              ${g.grid.map((ch,idx)=>`
                <div class="wsCell ${g.sel.has(idx)?'sel':''} ${g.ok.has(idx)?'ok':''}" onclick="wsToggle('${gameId}',${idx})">${ch}</div>
              `).join("")}
            </div>

            <div class="wsBar">
              <input class="wsInput" id="${gameId}_word" value="${safeText(g.currentWord)}" readonly />
              <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="wsRegister('${gameId}',${pdaNum})">‚ûï Registrar palabra</button>
              <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="wsClearSel('${gameId}')">üßπ Limpiar selecci√≥n</button>
            </div>

            <div class="small" style="margin-top:8px">Palabras a encontrar: <b>${cfg.words.join(", ")}</b></div>
            <div class="small">Encontradas: <b id="${gameId}_found">${g.found.join(", ") || "‚Äî"}</b></div>
          </div>

          <div class="row no-print">
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="gradeWORDSEARCH('${grade}',${pdaNum},${n},'${gameId}',${cfg.words.length})">‚úÖ Calificar</button>
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="resetWORDSEARCH('${gameId}',${cfg.words.length})">üîÄ Reiniciar</button>
          </div>

          <div id="status_${actKey}" class="status info"><div class="ico">i</div><div>Selecciona letras para formar una palabra y reg√≠strala.</div></div>
        `;
        // si locked, deshabilitar botones (ya por clase) pero celdas siguen seleccionando; lo evitamos:
        if(locked){
          document.querySelectorAll(`#${gameId}_grid .wsCell`).forEach(c=>c.style.pointerEvents="none");
        }
        return;
      }

      if(cfg.type==="memory"){
        const gameId=`mem_${grade}_${pdaNum}_${n}`;
        if(!state.game[gameId]){
          state.game[gameId] = initMemory(cfg.pairs);
        }
        const g = state.game[gameId];

        box.innerHTML = `
          ${header}
          <div class="q">
            <div class="qt">Memorama</div>
            <div class="small">Voltea dos tarjetas y busca el par. Pares logrados: <b>${g.matchedCount}</b> / ${g.totalPairs}</div>
            <div class="memGrid" id="${gameId}_grid">
              ${g.cards.map((c,i)=>`
                <div class="memCard ${c.matched?'matched':''} ${c.revealed?'revealed':''}"
                  onclick="${locked?'void(0)':'flipMem(\''+gameId+'\','+i+')'}">
                  ${c.revealed || c.matched ? safeText(c.text) : "‚ùì"}
                </div>
              `).join("")}
            </div>
            <div class="row no-print">
              <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="resetMEM('${gameId}')">üîÄ Revolver</button>
            </div>
          </div>

          <div class="row no-print">
            <button class="btn btn-primary ${locked?'btn-disabled':''}" onclick="gradeMEM('${grade}',${pdaNum},${n},'${gameId}')">‚úÖ Calificar</button>
          </div>

          <div id="status_${actKey}" class="status info"><div class="ico">i</div><div>Completa pares y califica. Puntaje = pares logrados.</div></div>
        `;
        return;
      }

      // fallback
      box.innerHTML = `${header}<div class="status warn"><div class="ico">!</div><div>Actividad no configurada.</div></div>`;
    }

    /* ===================== MATCH (etiquetas) ===================== */
    function matchPickRight(gameId, idx){
      state.game[gameId].pick = idx;
      updateMatchPickLabel(gameId);
    }
    function matchAssign(gameId, row){
      const pick = state.game[gameId].pick;
      if(pick==null) return;
      state.game[gameId].sel[row] = pick;
      // re-render suave actualizando men√∫: recargamos PDA actual
      loadPDA(state.pdaIndex);
    }
    function updateMatchPickLabel(gameId){
      const el = document.getElementById(gameId+"_pick");
      if(!el) return;
      const pick = state.game[gameId]?.pick;
      el.textContent = (pick==null) ? "‚Äî" : (pick===0 ? "DESCRIPCI√ìN" : "EXPLICACI√ìN");
    }
    function gradeMATCH(grade,pdaNum,n,gameId){
      const actKey=keyAct(grade,pdaNum,(n===1)?"A1":"A2");
      if(getAttempts(actKey)>=2) return;
      const cfg=MODULES[grade][pdaNum-1][(n===1)?"act1":"act2"];
      const sel=state.game[gameId].sel;
      if(sel.some(v=>v==null)){
        setStatus(actKey,"warn","Asigna todas las filas antes de calificar.");
        return;
      }
      let score=0;
      for(let i=0;i<sel.length;i++) if(sel[i]===cfg.correct[i]) score++;
      const max=sel.length;

      incAttempts(actKey);
      setScore(actKey,score,max);

      if(score===max){ setStatus(actKey,"ok",`¬°Perfecto! ${score}/${max}`); markBadge("üîó Relacionador"); }
      else if(score>=Math.ceil(max*0.75)) setStatus(actKey,"ok",`¬°Muy bien! ${score}/${max}`);
      else setStatus(actKey,"bad",`Puntaje: ${score}/${max}. Revisa qu√© es descripci√≥n vs explicaci√≥n.`);

      renderPdaResults(grade,pdaNum); buildMenu();
      // bloquear re-render
      renderActivity(grade,pdaNum,n,cfg);
    }
    function resetMATCH(gameId,len){
      state.game[gameId]={ sel:Array(len).fill(null), pick:null };
      loadPDA(state.pdaIndex);
    }

    /* ===================== MATCHPAIRS (drag/drop) ===================== */
    function wireLeftDrag(gameId){
      const left = document.getElementById(gameId+"_left");
      if(!left) return;
      left.querySelectorAll("[draggable='true']").forEach(el=>{
        el.addEventListener("dragstart", e=>dragStart(e, gameId));
      });
    }
    function dragStart(e, gameId){
      const did = e.target.getAttribute("data-did");
      e.dataTransfer.setData("text/plain", did);
      e.dataTransfer.setData("gameId", gameId);
    }
    function dropOn(e, gameId, rightIndex){
      const did = parseInt(e.dataTransfer.getData("text/plain"),10);
      // evitar duplicados: si ya estaba en otra zona, lo quitamos de ah√≠
      for(let i=0;i<state.game[gameId].placed.length;i++){
        if(state.game[gameId].placed[i]===did) state.game[gameId].placed[i]=null;
      }
      state.game[gameId].placed[rightIndex]=did;
      loadPDA(state.pdaIndex);
    }
    function clearDrop(gameId, idx){
      state.game[gameId].placed[idx]=null;
      loadPDA(state.pdaIndex);
    }
    function gradeMATCHPAIRS(grade,pdaNum,n,gameId){
      const actKey=keyAct(grade,pdaNum,(n===1)?"A1":"A2");
      if(getAttempts(actKey)>=2) return;
      const cfg=MODULES[grade][pdaNum-1][(n===1)?"act1":"act2"];
      const placed=state.game[gameId].placed;
      if(placed.some(v=>v==null)){
        setStatus(actKey,"warn","Completa todas las consecuencias antes de calificar.");
        return;
      }
      let score=0;
      for(let i=0;i<placed.length;i++){
        // correcto si el id coincide con el √≠ndice del par
        if(placed[i]===i) score++;
      }
      const max=placed.length;

      incAttempts(actKey);
      setScore(actKey,score,max);

      if(score===max){ setStatus(actKey,"ok",`¬°Perfecto! ${score}/${max}`); markBadge("üß© Causa-Consecuencia"); }
      else if(score>=Math.ceil(max*0.75)) setStatus(actKey,"ok",`¬°Muy bien! ${score}/${max}`);
      else setStatus(actKey,"bad",`Puntaje: ${score}/${max}. Relee conectores y relaciones.`);

      renderPdaResults(grade,pdaNum); buildMenu();
      renderActivity(grade,pdaNum,n,cfg);
    }
    function resetMATCHPAIRS(gameId,len){
      state.game[gameId]={ placed:Array(len).fill(null) };
      loadPDA(state.pdaIndex);
    }

    /* ===================== ORDER (drag sort) ===================== */
    function enableDragSort(listId){
      const list=document.getElementById(listId);
      if(!list) return;
      let dragEl=null;

      list.querySelectorAll("[draggable='true']").forEach(el=>{
        el.addEventListener("dragstart", e=>{
          dragEl=el;
          e.dataTransfer.effectAllowed="move";
          el.style.opacity="0.6";
        });
        el.addEventListener("dragend", ()=>{
          if(dragEl) dragEl.style.opacity="1";
          dragEl=null;
        });
        el.addEventListener("dragover", e=>{e.preventDefault(); e.dataTransfer.dropEffect="move";});
        el.addEventListener("drop", e=>{
          e.preventDefault();
          if(!dragEl || dragEl===el) return;
          const rect=el.getBoundingClientRect();
          const after=(e.clientY-rect.top)>(rect.height/2);
          if(after) el.parentNode.insertBefore(dragEl, el.nextSibling);
          else el.parentNode.insertBefore(dragEl, el);
        });
      });
    }
    function getOrderIds(listId){
      const list=document.getElementById(listId);
      if(!list) return [];
      return Array.from(list.children).map(ch=>parseInt(ch.getAttribute("data-oid"),10));
    }
    function gradeORDER(grade,pdaNum,n,listId){
      const actKey=keyAct(grade,pdaNum,(n===1)?"A1":"A2");
      if(getAttempts(actKey)>=2) return;
      const cfg=MODULES[grade][pdaNum-1][(n===1)?"act1":"act2"];
      const current=getOrderIds(listId);
      if(!current.length){ setStatus(actKey,"warn","No se pudo leer el orden."); return; }
      let score=0;
      for(let i=0;i<cfg.correctOrder.length;i++){
        if(current[i]===cfg.correctOrder[i]) score++;
      }
      const max=cfg.correctOrder.length;

      incAttempts(actKey);
      setScore(actKey,score,max);

      if(score===max){ setStatus(actKey,"ok",`¬°Orden perfecto! ${score}/${max}`); markBadge("üïí L√≠nea de tiempo"); }
      else if(score>=Math.ceil(max*0.75)) setStatus(actKey,"ok",`¬°Casi! ${score}/${max}`);
      else setStatus(actKey,"bad",`Puntaje: ${score}/${max}. Reordena y vuelve a intentar.`);

      renderPdaResults(grade,pdaNum); buildMenu();
      renderActivity(grade,pdaNum,n,cfg);
    }
    function shuffleORDER(listId){
      const list=document.getElementById(listId);
      if(!list) return;
      const children=Array.from(list.children).map(el=>({el, r:Math.random()})).sort((a,b)=>a.r-b.r).map(o=>o.el);
      list.innerHTML="";
      children.forEach(el=>list.appendChild(el));
      enableDragSort(listId);
    }

    /* ===================== HANGMAN ===================== */
    function initHangman(words){
      const targets = words.map(w=>w.toUpperCase().replace(/√Å/g,"A").replace(/√â/g,"E").replace(/√ç/g,"I").replace(/√ì/g,"O").replace(/√ö/g,"U"));
      return { targets, index:0, current:targets[0]||"", revealed:new Set(), used:new Set(), misses:0, wins:0 };
    }
    function hangmanKeyboardHTML(gameId, locked){
      const letters="ABCDEFGHIJKLMN√ëOPQRSTUVWXYZ".split("");
      const g=state.game[gameId];
      return letters.map(L=>{
        const used = g.used.has(L);
        return `<button class="kbtn ${used?'used':''} ${locked?'btn-disabled':''}" onclick="guessLetter('${gameId}','${L}')">${L}</button>`;
      }).join("");
    }
    function guessLetter(gameId, L){
      const g=state.game[gameId];
      if(g.used.has(L)) return;
      g.used.add(L);

      const word=g.current;
      if(word.includes(L) || (L==="√ë" && word.includes("√ë"))){
        g.revealed.add(L);
        // check win
        const all = new Set(word.replace(/ /g,"").split(""));
        let ok=true;
        all.forEach(ch=>{ if(ch!==" " && !g.revealed.has(ch)) ok=false; });
        if(ok){
          g.wins++;
          // preparar siguiente, pero sin auto avanzar (para que el ni√±o vea)
        }
      }else{
        g.misses++;
      }
      loadPDA(state.pdaIndex);
    }
    function nextHangWord(gameId){
      const g=state.game[gameId];
      if(g.index < g.targets.length-1){
        g.index++;
        g.current=g.targets[g.index];
        g.revealed=new Set();
        g.used=new Set();
        g.misses=0;
      }
      loadPDA(state.pdaIndex);
    }
    function resetHangman(gameId){
      const g=state.game[gameId];
      state.game[gameId]=initHangman(g.targets);
      loadPDA(state.pdaIndex);
    }
    function gradeHANGMAN(grade,pdaNum,n,gameId){
      const actKey=keyAct(grade,pdaNum,(n===1)?"A1":"A2");
      if(getAttempts(actKey)>=2) return;

      const g=state.game[gameId];
      const max=5; // pediste 5 palabras; score = min(wins,5)
      const score=Math.min(g.wins, max);

      incAttempts(actKey);
      setScore(actKey,score,max);

      if(score===max){ setStatus(actKey,"ok",`¬°Excelente! ${score}/${max}`); markBadge("ü™¢ Ahorcado PRO"); }
      else if(score>=4) setStatus(actKey,"ok",`¬°Muy bien! ${score}/${max}`);
      else setStatus(actKey,"bad",`Puntaje: ${score}/${max}. Intenta adivinar m√°s palabras.`);

      renderPdaResults(grade,pdaNum); buildMenu();
      const cfg=MODULES[grade][pdaNum-1][(n===1)?"act1":"act2"];
      renderActivity(grade,pdaNum,n,cfg);
    }

    /* ===================== WORDSEARCH (sopa simple) ===================== */
    function initWordSearch(words, size){
      const W = words.map(w=>w.toUpperCase().replace(/√Å/g,"A").replace(/√â/g,"E").replace(/√ç/g,"I").replace(/√ì/g,"O").replace(/√ö/g,"U"));
      // grid random letters
      const letters="ABCDEFGHIJKLMN√ëOPQRSTUVWXYZ";
      const grid = Array(size*size).fill("").map(()=>letters[Math.floor(Math.random()*letters.length)]);
      // embed words horizontally if possible
      W.forEach((w,idx)=>{
        const row = idx % size;
        const maxStart = Math.max(0, size - w.length);
        const startCol = Math.floor(Math.random()*(maxStart+1));
        const start = row*size + startCol;
        for(let i=0;i<w.length;i++){
          grid[start+i]=w[i];
        }
      });
      return { size, grid, sel:new Set(), currentWord:"", found:[], ok:new Set() };
    }
    function wsToggle(gameId, idx){
      const g=state.game[gameId];
      if(g.ok.has(idx)) return;
      if(g.sel.has(idx)) g.sel.delete(idx); else g.sel.add(idx);
      // build currentWord in selection order (by idx asc) -> simple & r√°pido
      const arr=[...g.sel].sort((a,b)=>a-b);
      g.currentWord=arr.map(i=>g.grid[i]).join("");
      loadPDA(state.pdaIndex);
    }
    function wsClearSel(gameId){
      const g=state.game[gameId];
      g.sel.clear();
      g.currentWord="";
      loadPDA(state.pdaIndex);
    }
    function wsRegister(gameId){
      const g=state.game[gameId];
      const word=g.currentWord.toUpperCase();
      // locate module to get allowed list
      const grade=state.grade, pdaNum=state.pdaIndex+1;
      const cfg=MODULES[grade][pdaNum-1].act2;
      const target = cfg.words.map(w=>w.toUpperCase());
      if(target.includes(word) && !g.found.includes(word)){
        g.found.push(word);
        // mark selected as ok
        g.sel.forEach(i=>g.ok.add(i));
        wsClearSel(gameId);
      }else{
        // keep selection but do not clear; user can adjust
      }
      loadPDA(state.pdaIndex);
    }
    function gradeWORDSEARCH(grade,pdaNum,n,gameId,maxWords){
      const actKey=keyAct(grade,pdaNum,(n===1)?"A1":"A2");
      if(getAttempts(actKey)>=2) return;
      const g=state.game[gameId];
      const score = Math.min(g.found.length, maxWords);
      const max = maxWords;

      incAttempts(actKey);
      setScore(actKey,score,max);

      if(score===max){ setStatus(actKey,"ok",`¬°Perfecto! ${score}/${max}`); markBadge("üîé Sopa maestra"); }
      else if(score>=Math.ceil(max*0.75)) setStatus(actKey,"ok",`¬°Muy bien! ${score}/${max}`);
      else setStatus(actKey,"bad",`Puntaje: ${score}/${max}. Encuentra m√°s palabras.`);

      renderPdaResults(grade,pdaNum); buildMenu();
      const cfg=MODULES[grade][pdaNum-1][(n===1)?"act1":"act2"];
      renderActivity(grade,pdaNum,n,cfg);
    }
    function resetWORDSEARCH(gameId){
      // reiniciar con las mismas palabras/tama√±o
      const grade=state.grade, pdaNum=state.pdaIndex+1;
      const cfg=MODULES[grade][pdaNum-1].act2;
      state.game[gameId]=initWordSearch(cfg.words, cfg.gridSize||10);
      loadPDA(state.pdaIndex);
    }

    /* ===================== MEMORY ===================== */
    function initMemory(pairs){
      // cards: each pair -> 2 cards
      const cards=[];
      pairs.forEach((p,idx)=>{
        cards.push({pairId:idx, text:p[0], revealed:false, matched:false});
        cards.push({pairId:idx, text:p[1], revealed:false, matched:false});
      });
      // shuffle
      for(let i=cards.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [cards[i],cards[j]]=[cards[j],cards[i]];
      }
      return { cards, open:[], matchedCount:0, totalPairs:pairs.length };
    }
    function flipMem(gameId, idx){
      const g=state.game[gameId];
      const c=g.cards[idx];
      if(c.matched || c.revealed) return;
      if(g.open.length>=2) return;

      c.revealed=true;
      g.open.push(idx);

      if(g.open.length===2){
        const [a,b]=g.open;
        const ca=g.cards[a], cb=g.cards[b];
        if(ca.pairId===cb.pairId){
          ca.matched=true; cb.matched=true;
          g.matchedCount++;
          g.open=[];
        }else{
          // hide later
          setTimeout(()=>{
            ca.revealed=false; cb.revealed=false;
            g.open=[];
            loadPDA(state.pdaIndex);
          }, 650);
        }
      }
      loadPDA(state.pdaIndex);
    }
    function resetMEM(gameId){
      const grade=state.grade, pdaNum=state.pdaIndex+1;
      const cfg=MODULES[grade][pdaNum-1].act2;
      state.game[gameId]=initMemory(cfg.pairs);
      loadPDA(state.pdaIndex);
    }
    function gradeMEM(grade,pdaNum,n,gameId){
      const actKey=keyAct(grade,pdaNum,(n===1)?"A1":"A2");
      if(getAttempts(actKey)>=2) return;
      const g=state.game[gameId];
      const score=g.matchedCount;
      const max=g.totalPairs;

      incAttempts(actKey);
      setScore(actKey,score,max);

      if(score===max){ setStatus(actKey,"ok",`¬°Perfecto! ${score}/${max}`); markBadge("üß† Memorama"); }
      else if(score>=Math.ceil(max*0.75)) setStatus(actKey,"ok",`¬°Muy bien! ${score}/${max}`);
      else setStatus(actKey,"bad",`Puntaje: ${score}/${max}. Intenta completar m√°s pares.`);

      renderPdaResults(grade,pdaNum); buildMenu();
      const cfg=MODULES[grade][pdaNum-1][(n===1)?"act1":"act2"];
      renderActivity(grade,pdaNum,n,cfg);
    }
  </script>

</body>
</html>
